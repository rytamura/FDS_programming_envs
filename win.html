<h1 id="miniforge-vs-code-によるpythonr-環境構築windows編">Miniforge +
VS Code によるPython/R 環境構築(Windows編)</h1>
<h2 id="はじめに">はじめに</h2>
<p>データサイエンスや機械学習の分野で研究・開発を行うためには、安定したプログラミング環境が欠かせません。
本資料では、次の2つのツールを導入していきます。</p>
<ul>
<li><strong>Miniforge（ミニフォージ）</strong>： Python
の代表的な環境構築ツール conda
を、より軽量かつ最新の形で利用できる仕組みです。データ解析や AI
開発に必要なライブラリを簡単に追加でき、さらに Jupyter
Notebook（ジュピター）
を通じて、コードと文章・図を組み合わせた“実験ノート”を作ることだってできます。
<ul>
<li>[余談だけど重要なこと]
これまで世界中の大学では、学生にAnaconda(アナコンダ)という名称の無料の環境構築ツールをインストールするよう指示してきました。ところが2020年くらいから、たとえ大学であっても大人数授業で使う場合は、Anacondaの利用に際して料金を支払うようにライセンスが改悪されてしまいました。それでは困るので、同じような機能かつ<em>無償利用が保証され、しかもMacではAnacondaよりも動作が早い</em>、Miniforgeを採用する企業や大学が増えてきています。</li>
</ul></li>
<li><strong>Visual Studio Code（VS
Code／ブイエスコード）</strong>：Microsoft
社が開発する高機能エディタで、Python や R
を効率よく書くための便利な機能が豊富にそろっています。世界中の学生・研究者・エンジニアに利用されており、プログラミング学習から実務まで幅広く活用できます。当然、無料で使うことができます。</li>
</ul>
<p>これらを組み合わせて使うことで、授業や研究だけでなく、業界でも通用する「プロフェッショナルな作業環境」を自分のPCに整えることができます。</p>
<h2
id="インストール作業を始める前の準備">インストール作業を始める前の準備</h2>
<h3
id="準備1インストール先フォルダを作る">準備1：インストール先フォルダを作る</h3>
<p>Windowsでは通常クラウド同期機能の「One
Drive」が動いています。また、ユーザー名に日本語や空白が含まれていることもあります。これらはインストール作業で原因不明のエラーの原因となります。</p>
<p>授業や研究などで、このような面倒かつ不明な障害を出来るだけ回避するため、これから<strong>MiniforgeをWindowsのルート(<code>C:¥</code>)直下に新しく作ったフォルダの中にインストールしていきます</strong>。その方法を説明します。</p>
<p>Windowsの画面下にある「🔍検索」フィールドに、半角小文字で
<code>e</code> と入力し、表示された候補の中から、<strong>エクスプローラ
Explorer</strong> をクリックして起動します。</p>
<p>エクスプローラの左側に多くの項目がありますが、下の方に<code>🖥️ PC</code>という項目とアイコンがあります。これをクリックします。</p>
<figure>
<img src="screenshots/win_prep0.png" alt="win_prep0" />
<figcaption aria-hidden="true">win_prep0</figcaption>
</figure>
<p>すると、右側の広いウィンドウに「ローカルディスク
(C:)」というのが出現するはずです。ここはWindowsシステムやアプリ、ユーザー領域といったすべてのハードディスクの内容が保存されている「ルートフォルダ」と呼ばれているもので、「<strong>Cドライブ</strong>」と呼称することもあります。</p>
<figure>
<img src="screenshots/win_prep1.png" alt="win_prep1" />
<figcaption aria-hidden="true">win_prep1</figcaption>
</figure>
<p>これを<strong>ダブルクリック</strong>すると、<code>C</code>の中に含まれるフォルダ一覧が表示されます。何も表示されていない領域にマウスを移動して右クリックし、「<strong>新規作成
→ フォルダ</strong>」を選びます。</p>
<figure>
<img src="screenshots/win_prep2.png" alt="win_prep2" />
<figcaption aria-hidden="true">win_prep2</figcaption>
</figure>
<figure>
<img src="screenshots/win_prep3.png" alt="win_prep3" />
<figcaption aria-hidden="true">win_prep3</figcaption>
</figure>
<p>新しく作成されたフォルダが、インストール先になります。次の名前を入力してください：</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bat"><code class="sourceCode dosbat"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>miniforge3</span></code></pre></div>
<figure>
<img src="screenshots/win_prep4.png" alt="win_prep4" />
<figcaption aria-hidden="true">win_prep4</figcaption>
</figure>
<p>すぐ後の作業で、新しく作ったこのフォルダ<code>miniforge3</code>にMiniforgeをインストールしていくので、確実に作ってください。</p>
<p><strong>以上で準備は完了です！</strong></p>
<h2 id="miniforge3のインストール">Miniforge3のインストール</h2>
<h3 id="インストーラーのダウンロード">1.
インストーラーのダウンロード</h3>
<p>SafariやChromeなどで、MiniforgeのWebサイト： <a
href="https://conda-forge.org/download/">https://conda-forge.org/download/</a>にアクセスします。WindowsのアイコンのあるWindows用Miniforgeインストーラーをクリックしてダウンロードしてください。</p>
<figure>
<img src="screenshots/win_dl1.png" alt="win_dl1" />
<figcaption aria-hidden="true">win_dl1</figcaption>
</figure>
<h4
id="ダウンロードのときのセキュリティ問題に対処する">ダウンロードのときのセキュリティ問題に対処する</h4>
<p>最近のWindowsでは、あまり有名でないMiniforgeインストーラーをダウンロードすると、Windows
Defender(Windowsが使うセキュリティ保護アプリ)が「このインストーラーは信頼できないので実行させません」などと強権を行使して妨害してくることがあります：</p>
<figure>
<img src="screenshots/win_dl2.png" alt="win_dl2" />
<figcaption aria-hidden="true">win_dl2</figcaption>
</figure>
<p>このままだとMiniforgeをインストールできないので、次の手順で対処します。</p>
<p>STEP 1: 上の画像で右端にある「<span
class="math inline">⋯</span>」という部分をクリックしてください。</p>
<p>STEP 2:
出現したウィンドウメニューの中から、<strong>保存</strong>を選択します。</p>
<figure>
<img src="screenshots/win_dl3.png" alt="win_dl3" />
<figcaption aria-hidden="true">win_dl3</figcaption>
</figure>
<p>STEP
3：すると、信頼できることを確認してくださいとかなんとか警告するウィンドウが現れるので、<strong>削除</strong>ボタンの下向き矢印をクリックして、「<strong>保持する</strong>」を選択します。</p>
<figure>
<img src="screenshots/win_dl4.png" alt="win_dl4" />
<figcaption aria-hidden="true">win_dl4</figcaption>
</figure>
<p>STEP
4：これで警告は消え、Miniforgeインストーラーが使えるようになりました。<strong>ファイルを開く</strong>をクリックして、インストーラーを起動します（少々時間がかかります）。</p>
<figure>
<img src="screenshots/win_dl5.png" alt="win_dl5" />
<figcaption aria-hidden="true">win_dl5</figcaption>
</figure>
<h3 id="インストール作業開始">2. インストール作業開始</h3>
<p>Miniforgeインストーラーが起動したら、<code>[Next &gt;]</code>をクリックします。</p>
<figure>
<img src="screenshots/win_mf1.png" alt="win_mf1" />
<figcaption aria-hidden="true">win_mf1</figcaption>
</figure>
<p>次のライセンス同意画面では、<code>[I Agree]</code>をクリックします。</p>
<figure>
<img src="screenshots/win_mf2.png" alt="win_mf2" />
<figcaption aria-hidden="true">win_mf2</figcaption>
</figure>
<p>次の画面では、<code>Just Me (recommended)</code>にチェックが入っていることを確認して<code>[Next &gt;]</code>をクリックします。</p>
<figure>
<img src="screenshots/win_mf3.png" alt="win_mf3" />
<figcaption aria-hidden="true">win_mf3</figcaption>
</figure>
<p>次の画面で、先ほど作成したインストール先フォルダを設定します(下図も参照)。<code>Destination Folder</code>に書かれている場所がインストール先フォルダの規定値ですが、日本語PCではトラブルが頻出してますので、変更します。<code>[Brouwse]</code>ボタンをクリックします。</p>
<figure>
<img src="screenshots/win_mf4.png" alt="win_mf4" />
<figcaption aria-hidden="true">win_mf4</figcaption>
</figure>
<p><code>[Browse]</code>をクリックすると、手動でインストール先フォルダを選択するよう求められます。先ほど作成した、<code>miniforge3</code>というフォルダが<code>ローカルディスク(C)</code>の下にあるはずなので、それをマウスで選択して、[OK]をクリックします（下図も参照）。</p>
<figure>
<img src="screenshots/win_mf5.png" alt="win_mf5" />
<figcaption aria-hidden="true">win_mf5</figcaption>
</figure>
<figure>
<img src="screenshots/win_mf6.png" alt="win_mf6" />
<figcaption aria-hidden="true">win_mf6</figcaption>
</figure>
<p>設定を終えると、Destination
Folderが<code>C:¥miniforge3¥</code>に変更されているはずです。</p>
<figure>
<img src="screenshots/win_mf7.png" alt="win_mf7" />
<figcaption aria-hidden="true">win_mf7</figcaption>
</figure>
<p>設定が変更されているのを確認したら、<code>[Next &gt;]</code>をクリックします。</p>
<p>次に現れる画面は、Windowsインストール時のオプション機能です。下図に示したように、1・3・4番目のオプションにチェックを入れてください(<strong>必須</strong>。そして2番目には絶対チェックをいれない)。</p>
<figure>
<img src="screenshots/win_mf8.png" alt="win_mf8" />
<figcaption aria-hidden="true">win_mf8</figcaption>
</figure>
<p><code>[Install]</code>をクリックして、インストールを開始します。</p>
<figure>
<img src="screenshots/win_mf9.png" alt="win_mf9" />
<figcaption aria-hidden="true">win_mf9</figcaption>
</figure>
<p>インストールには5-10分程度かかります。以下の2つの画像のようなウィンドウが表示されれば、インストールは完了です。</p>
<figure>
<img src="screenshots/win_mf10.png" alt="win_mf10" />
<figcaption aria-hidden="true">win_mf10</figcaption>
</figure>
<figure>
<img src="screenshots/win_mf11.png" alt="win_mf11" />
<figcaption aria-hidden="true">win_mf11</figcaption>
</figure>
<p><strong>以上の作業で、MiniforgeはみなさんのWindowsにインストールされました！</strong></p>
<h4 id="注意">注意</h4>
<p>ここまでの作業がうまくいかなかったり、途中でエラーっぽい症状が出て先に進めない場合、遠慮なく私の研究室までPCを持参してください。すぐに治して使えるようにします。</p>
<p>次は、Miniforgeを用いて、Pythonプログラミング環境の<strong>初期設定</strong>を行っていきます。</p>
<h2
id="pythonプログラミング環境の初期設定">Pythonプログラミング環境の初期設定</h2>
<p>Miniforgeシステムをデータサイエンスに適したようにカスタマイズするには、<strong>Miniforgeプロンプト</strong>(以下、単に”<strong>プロンプト</strong>”と<strong>略称</strong>する)という、Windowsのコマンドプロンプトと外見の似たアプリを使います。このアプリを使ってプログラミング環境を整えていきます。</p>
<figure>
<img src="screenshots/win_prompt0.png" alt="win_prompt0" />
<figcaption aria-hidden="true">win_prompt0</figcaption>
</figure>
<h3 id="conda-コマンドを使えるようにする">conda
コマンドを使えるようにする</h3>
<p>プロンプト上で動作し、Pythonプログラミング環境で必要なライブラリ・パッケージ群を準備したり整えたりするツールが<code>conda</code>(コンダ)です。</p>
<p>プロンプトに<code>conda [ENTER]</code>と入力し、プロンプトに下のようなメッセージが出力されることを確認しましょう。</p>
<p><img src="screenshots/win_prompt1.png" alt="win_prompt1" /> <img
src="screenshots/win_prompt2.png" alt="win_prompt2" /></p>
<h3
id="初期設定1miniforgeを最新の内容に更新">初期設定1：Miniforgeを最新の内容に更新</h3>
<p>さきほどインストールしたMiniforgeには、Pythonの機能を拡張するさまざまなライブラリが入っています。これらは日々、世界中に散在する開発者によって更新されていきます。よって、Miniforgeに含まれているライブラリも、最新のバージョンにしておく方がよいです。</p>
<p>そのために、次のコマンドをターミナルで実行します：</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bat"><code class="sourceCode dosbat"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>conda update <span class="at">-n</span> base conda <span class="at">-y</span></span></code></pre></div>
<figure>
<img src="screenshots/win_prompt3.png" alt="win_prompt3" />
<figcaption aria-hidden="true">win_prompt3</figcaption>
</figure>
<p>すると、たったいまインストールしたばかりのminiforgeに含まれるパッケージの中で更新されているものを検知し、最新のバージョンを自動的にダウンロード、インストールしてくれます。インストールには数分かかり、その間さまざまな出力がMiniforge
プロンプトを流れていきますが、アップデート作業が全部終わると、画面がクリーンアップされ、<code>done</code>という表示がプロンプト最上部に表示されるはずです。</p>
<figure>
<img src="screenshots/win_prompt4.png" alt="win_prompt4" />
<figcaption aria-hidden="true">win_prompt4</figcaption>
</figure>
<h3 id="初期設定2-学習研究用の仮想環境を作成する">初期設定2:
学習・研究用の「仮想環境」を作成する</h3>
<p>Miniforgeでは、Pythonの実行環境を「<strong>仮想環境</strong>」という”Pythonの利用が完結するエコシステム”単位で管理します。Miniforgeプロンプトの入力部に<code>(base)</code>というのが見えます。これはMiniforgeがインストールされたときに自動的に作成する”基本的な”仮想環境です。現在Miniforgeプロンプトは、Pythonの<code>base</code>という仮想環境の中で動いているのです。<code>base</code>は、Miniforgeシステムの中で管理者的役割を担っている仮想環境です。</p>
<p>私たちはデータ分析などの用途にPython環境を整えていくわけですが、こんなときは新たに専用の仮想環境を作ることが奨励されています。</p>
<h4 id="仮想環境dsの作成">仮想環境「ds」の作成</h4>
<p>この授業だけでなく、その他のPythonを使う授業や来年度のゼミでの研究活動のために、新しい仮想環境を作成します。<strong>新しい仮想環境には名前をつけることができ、名前は何でもよいのですが、短く簡潔に「ds」と命名</strong>
します。データサイエンス(<strong>d</strong>ata
<strong>s</strong>cience)の略です。Pythonのバージョンは、主要なデータサイエンス・機械学習ライブラリの動作確認がある<code>3.12</code>とします。次のコマンドをプロンプトで実行してください：</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bat"><code class="sourceCode dosbat"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>conda create <span class="at">-n</span> ds python=3.12 <span class="at">-y</span></span></code></pre></div>
<figure>
<img src="screenshots/win_prompt5.png" alt="win_prompt5" />
<figcaption aria-hidden="true">win_prompt5</figcaption>
</figure>
<p>ENTERして実行すると、多くの情報が出力されながら<strong>仮想環境
ds</strong>
が作成されます。下図のような画面になったら、作成成功です。</p>
<figure>
<img src="screenshots/win_prompt6.png" alt="win_prompt6" />
<figcaption aria-hidden="true">win_prompt6</figcaption>
</figure>
<h4 id="仮想環境dsを有効化する">仮想環境「ds」を有効化する</h4>
<p>上の画面の最後に指示があるようにプロンプトで次のコマンドを実行し、仮想環境
ds を有効化します：</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate ds</span></code></pre></div>
<p>プロンプトの入力行の先頭に<code>(ds)</code>が追加されます。現在このプロンプトは<strong>Pythonの仮想環境「ds」を動かしている</strong>という意味です。</p>
<figure>
<img src="screenshots/win_prompt7.png" alt="win_prompt7" />
<figcaption aria-hidden="true">win_prompt7</figcaption>
</figure>
<p>実際に、利用可能なPythonをチェックします。プロンプトに<code>python --version [ENTER]</code>と入力してください。</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="ex">ds</span><span class="kw">)</span> <span class="ex">ユーザ名@Mac名</span> Downloads % python <span class="at">--version</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">Python</span> 3.12.11</span></code></pre></div>
<p>仮想環境「ds」では、<code>Python 3.12.XX</code>(<code>XX</code>はバージョン番号)が使えることが分かります。</p>
<h2
id="データサイエンス関連ライブラリをインストールするpython">　データサイエンス関連ライブラリをインストールする(Python)</h2>
<p>仮想環境「ds」に、この授業やゼミで利用する、データサイエンス定番ライブラリをインストールします。次のコマンドをターミナルで実行してください。</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install <span class="at">-y</span> jupyterlab ipykernel numpy pandas matplotlib seaborn scipy scikit-learn</span></code></pre></div>
<p>たくさんのライブラリがすごい勢いで一括インストールされる様子を目にすると思います。終了まで10分程度かかります。プロンプトに<code>done</code>(終了)というメッセージが表示されれば終わりです。ちなみにインストールしたのは、世界標準かつデータ分析を行う人なら、学生からプロフェッショナルを問わず、皆使っている有名なPythonライブラリです。</p>
<ul>
<li><code>jupyterlab, ipykernel</code>：Visual Studio
Codeエディタとの連携</li>
<li><code>numpy, pandas</code>：データ操作ライブラリ</li>
<li><code>matplotlib, seaborn</code>：グラフ可視化ライブラリ</li>
<li><code>scipy, scikit-learn</code>：統計・機械学習関連ライブラリ</li>
</ul>
<h3
id="グラフの日本語文字化け問題対策パッケージを追加インストール">グラフの日本語文字化け問題対策パッケージを追加インストール</h3>
<p>日本語を操る私たちにとって、世界標準なライブラリを使う際に乗り越えるべき悩みは、グラフの日本語表示の文字化け問題です。日本人の有志の方々が公開している<code>matplotlib_fontja</code>というライブラリを導入すれば、その悩みから(ほぼ)解放されます。このライブラリはminiforgeシステムには登録されていないので、次のコマンドをターミナルで実行することで、インストールします。</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> <span class="at">-m</span> pip install matplotlib_fontja</span></code></pre></div>
<figure>
<img src="screenshots/win_prompt8.png" alt="win_prompt8" />
<figcaption aria-hidden="true">win_prompt8</figcaption>
</figure>
<p>コマンドを実行すると、次のようにダウンロードが自動的に始まり、<code>matplotlib_fontja</code>に関連する必須ライブラリも自動的にインストールされていきます：</p>
<figure>
<img src="screenshots/win_prompt9.png" alt="win_prompt9" />
<figcaption aria-hidden="true">win_prompt9</figcaption>
</figure>
<p>インストールが終わると、ターミナルの出力の下の方に<code>Succesfully installed ...</code>というメッセージが表示されます。</p>
<h2 id="jupyter-にカーネルを登録">Jupyter にカーネルを登録</h2>
<p>miniforge関連の最後の作業にとりかかります。今はプロンプトに色々なコマンドを入力したり、かなり複雑なことをやっていますが、授業や研究ではプロンプトはほぼ使わず、VS
Codeエディタのみの「シンプルな作業環境」を使います。VS
CodeとMiniforge(Python)とRを連携させる仕組みが<strong>jupyter</strong>というライブラリです。jupyterは仮想環境(ds)をVS
Codeから直接使う機能を提供します。</p>
<p><strong>ターミナルが仮想環境dsにいることを確認</strong>し、次のコマンドを実行してください：</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> <span class="at">-m</span> ipykernel install <span class="at">--user</span> <span class="at">--name</span> ds <span class="at">--display-name</span> <span class="st">&quot;Python(ds)&quot;</span></span></code></pre></div>
<figure>
<img src="screenshots/win_ipykernel1.png" alt="win_ipykernel" />
<figcaption aria-hidden="true">win_ipykernel</figcaption>
</figure>
<p>ターミナルの出力に<code>Installed kernelspec ds in ...</code>と表示されれば成功です。これは、仮想環境dsをVS
Codeで使う準備を行なったというメッセージです。</p>
<figure>
<img src="screenshots/win_ipykernel2.png" alt="win_ipykerne2" />
<figcaption aria-hidden="true">win_ipykerne2</figcaption>
</figure>
<h3 id="ここでブレイク">ここでブレイク🍵</h3>
<p>ここまででおそらく30-40分くらいかかったのではないかと思います。以上でPythonプログラミング環境はほぼ完成です。残りの作業は</p>
<ol type="1">
<li>Rのインストール：RStudio,
ExploratoryのようなRを使うアプリを既にインストールしてある場合は、<strong>この作業は不要です</strong>。</li>
<li>RをJupyterに登録：全員が作業します。</li>
<li>VS Codeのインストール：全員が作業します。</li>
<li>動作確認：PythonもRもVS
Codeというひとつの作業環境内で動作する便利さを実感してください。</li>
</ol>
<h2 id="r-のインストール">3. R のインストール</h2>
<p><strong>既にRStudioでRを動かしたことがある人は、Rのインストール作業は不要です。
4.Rカーネルの設定に進んでください。</strong></p>
<p>Mac版 R
のインストール方法は、以下のページがとても親切です。ここに書いてある通りの手順で作業を行い、最後の動作確認まで完了してください。</p>
<p><a
href="https://bigdata-analytics.jp/install-tools/install_r_for_mac/">https://bigdata-analytics.jp/install-tools/install_r_for_mac/</a></p>
<h2 id="r-カーネルの設定">4. R カーネルの設定</h2>
<p>スタートボタンからRを起動します。</p>
<p><strong>注意1:
Rstudioではありません。<code>R X.Y.Z</code>(X,Y,Zはバージョン番号)という名前のアプリです。見つからない場合は、下図のようにスタートボタンの検索で<code>R</code>と入力すれば出てきます。</strong></p>
<p><strong>注意2:
Rのバージョン番号は、お使いのPCによって異なります。ある人は<code>R 4.3.3</code>かもしれないし、別の人は<code>R 4.5.0</code>かもしれません。</strong>検索して複数ヒットした場合は、新しいバージョン番号の
R を選択しましょう**。</p>
<p><strong>注意3：起動したRのバージョン(<code>X.Y.Z</code>)を忘れずに覚えておいてください。下図ではR-4.5.1を起動しています。この情報はすぐ後で使います</strong></p>
<figure>
<img src="screenshots/win_Rapp.png" alt="Win R" />
<figcaption aria-hidden="true">Win R</figcaption>
</figure>
<p>出現したRコンソールに、以下のコマンドを入力（またはコピペ）します。</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;IRkernel&quot;</span>)</span></code></pre></div>
<p>もしこのRアプリを初めて起動した人は、次のようなメッセージが出ます。</p>
<figure>
<img src="screenshots/win_R0.png" alt="Rlibrary" />
<figcaption aria-hidden="true">Rlibrary</figcaption>
</figure>
<p>これは「外部ライブラリをネットからダウンロードしてインストールための、個人的なライブラリ置き場を設定してもよいか」という意味です。<code>[はい(Y)]</code>を選択します。さらに(なぜか)同じ主旨のメッセージダイアログが日本語でも出現することがあります。</p>
<figure>
<img src="screenshots/win_R1.png" alt="CRAN" />
<figcaption aria-hidden="true">CRAN</figcaption>
</figure>
<p>ここでも同様に<code>[はい(Y)]</code>を選択します。</p>
<p>すると、Rコンソールに：</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="sc">---</span> Please select a CRAN mirror <span class="cf">for</span> use <span class="cf">in</span> this session <span class="sc">---</span></span></code></pre></div>
<p>というメッセージが表示され、<strong>ダウンロード先のサーバーリスト</strong>一覧が表示された新しいウィンドウが現れることがあります。</p>
<figure>
<img src="screenshots/win_R2.png" alt="CRAN" />
<figcaption aria-hidden="true">CRAN</figcaption>
</figure>
<p><strong>リスト</strong>の最上部にある<code>0-Cloud[https]</code>をマウスで選択して、[OK]ボタンをクリックしればインストール作業が再開されます。インストールに少々時間がかかって、下のような画面になればOKです。</p>
<figure>
<img src="screenshots/win_R3.png" alt="IRKernel" />
<figcaption aria-hidden="true">IRKernel</figcaption>
</figure>
<p><strong>Rは一旦終了します</strong>(作業スペースを保存しますか？とか聞かれたら、<code>[いいえ(N)]</code>を選択します)</p>
<h3
id="minifogeとrのリンクを確立する">minifogeとRのリンクを確立する</h3>
<p>再びMiniforgeプロンプトに戻ります。<strong>もしMiniforgeプロンプトを終了していたら</strong>、慌てずMiniforgeプロンプトをもう一度起動して、次のコマンドを実行し、<strong>既に作成した仮想環境「ds」に入ります</strong>。</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bat"><code class="sourceCode dosbat"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>conda activate ds</span></code></pre></div>
<figure>
<img src="screenshots/win_R4.png" alt="ds revoke" />
<figcaption aria-hidden="true">ds revoke</figcaption>
</figure>
<p>さて、ここからとても大事な作業です。<strong>仮想環境
dsからさきほどRカーネルをインストールしたRのバージョンにリンクを貼ります。</strong>
そのためには、いま使っているMiniforgeプロンプト上で、さきほどのRを実行しないといけません。</p>
<p>Rのバージョン番号(3つ;
それぞれ仮に<code>X</code>,<code>Y</code>,<code>Z</code>とします)の情報を用いて、プロンプトに次のコマンドを入力します。</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bat"><code class="sourceCode dosbat"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;c:\Program Files\R\R-X.Y.Z\bin\x64\R.exe&quot;</span></span></code></pre></div>
<p><code>R-4.4.3</code>ならば：</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bat"><code class="sourceCode dosbat"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;c:\Program Files\R\R-4.4.3\bin\x64\R.exe&quot;</span></span></code></pre></div>
<p><code>R-4.5.0</code>ならば：</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bat"><code class="sourceCode dosbat"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;c:\Program Files\R\R-4.5.0\bin\x64\R.exe&quot;</span></span></code></pre></div>
<p>というコマンドをプロンプトに入力します。注意：コマンドの先頭と末尾の二重引用符<code>"</code>は<strong>必ずつけてください</strong></p>
<p>下図の先頭行にその状況が示されています。ここでは<code>R-4.5.1</code>のRコンソールを、<strong>仮想環境ds上で起動</strong>しています(ここがポイント)。</p>
<figure>
<img src="screenshots/win_R5.png" alt="R console" />
<figcaption aria-hidden="true">R console</figcaption>
</figure>
<p>上の図にあるように。Rコンソールに次の2行をコピペして実行してください。</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(IRkernel)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>IRkernel<span class="sc">::</span><span class="fu">installspec</span>()</span></code></pre></div>
<p>実行しても<strong>何も起こりませんがそれでOKです</strong>。むしろエラーっぽい状況が発生したら、私に相談してください。</p>
<p>以上でminiforgeとRのリンクは確立されました。Rを終了しましょう。上図のようにRコンソールに<code>q()[ENTER]</code>と入力して<code>Save workspace image? [y/n/c]</code>と表示されるので、キーボードの<code>n</code>を入力すれば、Rは終了します。</p>
<h2 id="vs-code-のインストール">5. VS Code のインストール</h2>
<p><a
href="https://code.visualstudio.com/">https://code.visualstudio.com/</a>
から VS Code
をダウンロードします。SafariやChromeでこのWebサイトを開くと、目立つところに窓マーク＋Download
for Windows
というリンクが見えるので、それをクリックしてインストーラーをダウンロードします。</p>
<figure>
<img src="screenshots/win_vsc0.png" alt="vscode_win" />
<figcaption aria-hidden="true">vscode_win</figcaption>
</figure>
<figure>
<img src="screenshots/win_vsc1.png" alt="win_vsc1" />
<figcaption aria-hidden="true">win_vsc1</figcaption>
</figure>
<p>ダウンロードしたインストーラーの「ファイルを開く」をクリックして、インストールを開始します。インストールはとても簡単で、常に<code>[次へ/Next &gt;]</code>または<code>[Install]</code>ボタンをクリックしていけばOKです。</p>
<p><img src="screenshots/win_vsc2.png" alt="win_vsc2" /> <img
src="screenshots/win_vsc3.png" alt="win_vsc3" /> <img
src="screenshots/win_vsc4.png" alt="win_vsc4" />
インストールオプションでは、<code>その他</code>の4つにオプションを入れると便利です（必須ではありません）。
<img src="screenshots/win_vsc5.png" alt="win_vsc5" /> <img
src="screenshots/win_vsc6.png" alt="win_vsc6" /> <img
src="screenshots/win_vsc7.png" alt="win_vsc7" /></p>
<p>Windowsスタートメニューの中に<code>Visual Studio Code</code>というアプリがインストールされているので、これをクリックして起動します。</p>
<h3 id="vs-codeの環境設定">VS Codeの環境設定</h3>
<p>VS
Codeはものすごく高機能なエディタで、AIエディタ（AIと相談しながらプログラムコードを書いていく）としても活用できます。その方法はおいおい詳述するとして、ここでは日々使うプログラミングエディタとして、必須の環境設定を行います。</p>
<h4 id="vs-codeを日本語化する">VS Codeを日本語化する</h4>
<p>VS
Codeはデフォルトでは英語表示になっています。ウィンドウ左端の「拡張機能アイコン」をクリックし、検索窓に<code>japanese</code>と入力します。すると、<strong>Japanese
Language Pack for Visual Studio
Code</strong>という拡張機能があります。これはVS
Codeの外観やメニューをできる限り日本語表示してくれます。</p>
<figure>
<img src="screenshots/win_vsc8.png" alt="win_vsc8" />
<figcaption aria-hidden="true">win_vsc8</figcaption>
</figure>
<p>右下に青字に白文字で「<strong>install</strong>」というボタンがあるので、それをクリックすると、拡張機能がインストールされます。</p>
<figure>
<img src="screenshots/win_vsc9.png" alt="win_vsc9" />
<figcaption aria-hidden="true">win_vsc9</figcaption>
</figure>
<p>インストールが成功すると、下のようなメッセージが表示されるので、<code>Change Language and Restart</code>をクリックすれば、<strong>日本語化された
VS
Code</strong>が出現します。よく使うメニューや説明が日本語に切り替わっていることに気づくと思います。</p>
<figure>
<img src="screenshots/win_vsc10.png" alt="win_vsc10" />
<figcaption aria-hidden="true">win_vsc10</figcaption>
</figure>
<h4 id="python拡張機能">Python拡張機能</h4>
<p>再び機能拡張ボタンをクリックします：</p>
<figure>
<img src="screenshots/win_vsc11.png" alt="win_vsc11" />
<figcaption aria-hidden="true">win_vsc11</figcaption>
</figure>
<p>出現した検索窓に<code>Python</code>と入力して下さい。そして出現した拡張機能のうち、次の2つを見つけます</p>
<ul>
<li><strong>Python</strong>：Pythonプログラミングに最適な機能を提供(開発者：Microsoft)</li>
<li><strong>Pylance</strong>：Pythonプログラミング文法を自動スペルチェック(開発者：Microsoft)</li>
</ul>
<figure>
<img src="screenshots/win_vsc12.png" alt="win_vsc12" />
<figcaption aria-hidden="true">win_vsc12</figcaption>
</figure>
<p>おそらく拡張機能<strong>Python</strong>をインストールすると、<strong>自動的にPylanceもインストールされる</strong>はずです。</p>
<h4 id="jupyter拡張機能">Jupyter拡張機能</h4>
<p>検索窓に<code>Jupyter</code>と入力して下さい。そして出現した拡張機能のうち、次の3つを見つけて、<strong>インストール</strong>してください。</p>
<figure>
<img src="screenshots/win_vsc13.png" alt="win_vsc13" />
<figcaption aria-hidden="true">win_vsc13</figcaption>
</figure>
<ul>
<li><strong>Jupyter</strong>：Jupyter拡張機能本体 (開発者:
Microsoft)</li>
<li><strong>Jupyter
Keymap</strong>：Jupyter操作にショートカットを提供(開発者：Microsoft)</li>
<li><strong>Jupyter Cell
Tags</strong>：プログラムにタグをつける(開発者：Microsoft)</li>
</ul>
<p><strong>Jupyter</strong>をインストールすれば、自動的に他の２つもインストールされるはずです。</p>
<h3 id="おめでとうございます">おめでとうございます</h3>
<p>以上でPython+Rのプログラミング環境の基本設定は完成です！</p>
<p>プロンプトを終了してOKです（当分使いません）。</p>
